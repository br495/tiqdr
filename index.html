<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>إصدارات عماد الجزيري المجانية</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />
    <style>
      :root {
        --primary-color: #4a6fa5;
        --secondary-color: #6e9fe3;
        --accent-color: #c5d5ea;
        --light-bg: #f7f9fc;
        --dark-bg: #1a202c;
        --light-card-bg: #ffffff;
        --dark-card-bg: #2d3748;
        --light-text: #334155;
        --dark-text: #e2e8f0;
        --light-border: #e2e8f0;
        --dark-border: #4a5568;
        --light-hover: #edf2f7;
        --dark-hover: #2c3e50;
        --light-shadow: rgba(0, 0, 0, 0.1);
        --dark-shadow: rgba(0, 0, 0, 0.3);
      }

      body {
        transition: background-color 0.3s ease, color 0.3s ease;
        background-color: var(--light-bg);
        color: var(--light-text);
      }

      body.dark-mode {
        background-color: var(--dark-bg);
        color: var(--dark-text);
      }

      .video-container {
        position: relative;
        padding-bottom: 56.25%;
        height: 0;
        overflow: hidden;
        max-width: 100%;
        border-radius: 0.75rem;
        box-shadow: 0 4px 10px var(--light-shadow);
        background-color: #000;
        margin: 1rem 0;
        transition: box-shadow 0.3s ease;
      }

      .dark-mode .video-container {
        box-shadow: 0 4px 10px var(--dark-shadow);
      }

      .video-container iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border-radius: 0.75rem;
        border: none;
      }

      .bank-link {
        cursor: pointer;
        transition: all 0.3s ease;
        border-right: 3px solid transparent;
      }

      .bank-link:hover {
        background-color: var(--light-hover);
        transform: translateX(-5px);
        border-right: 3px solid var(--primary-color);
      }

      .dark-mode .bank-link:hover {
        background-color: var(--dark-hover);
      }

      .pdf-container {
        width: 100%;
        border: 1px solid var(--light-border);
        border-radius: 0.75rem;
        overflow: hidden;
        box-shadow: 0 4px 10px var(--light-shadow);
        background: var(--light-bg);
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
      }

      .dark-mode .pdf-container {
        border-color: var(--dark-border);
        box-shadow: 0 4px 10px var(--dark-shadow);
      }

      .pdf-container object {
        display: block;
        background: white;
      }

      .card {
        margin-bottom: 20px;
        box-shadow: 0 4px 10px var(--light-shadow);
        border-radius: 0.75rem;
        overflow: hidden;
        border: none;
        background-color: var(--light-card-bg);
        transition: background-color 0.3s ease, box-shadow 0.3s ease;
      }

      .dark-mode .card {
        background-color: var(--dark-card-bg);
        box-shadow: 0 4px 10px var(--dark-shadow);
      }

      .card-title {
        border-bottom: 2px solid var(--accent-color);
        padding-bottom: 10px;
        margin-bottom: 15px;
        color: var(--primary-color);
        font-weight: 600;
        transition: color 0.3s ease, border-color 0.3s ease;
      }

      .dark-mode .card-title {
        border-bottom-color: var(--secondary-color);
        color: var(--secondary-color);
      }

      .card-body {
        padding: 1.5rem;
      }

      .btn-group {
        flex-wrap: wrap;
        gap: 5px;
        justify-content: center;
      }

      .btn-group .btn {
        border-radius: 0.5rem !important;
        margin: 0.25rem;
        box-shadow: 0 2px 4px var(--light-shadow);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .btn-group .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px var(--light-shadow);
      }

      .dark-mode .btn-group .btn {
        box-shadow: 0 2px 4px var(--dark-shadow);
      }

      .dark-mode .btn-group .btn:hover {
        box-shadow: 0 4px 8px var(--dark-shadow);
      }

      @media (max-width: 768px) {
        .btn-group .btn {
          flex: 1 0 45%;
          margin: 3px;
        }
      }

      .content-wrapper {
        background: var(--light-card-bg);
        border-radius: 0.75rem;
        box-shadow: 0 4px 12px var(--light-shadow);
        padding: 1.5rem;
        margin-bottom: 2rem;
        transition: background-color 0.3s ease, box-shadow 0.3s ease;
      }

      .dark-mode .content-wrapper {
        background: var(--dark-card-bg);
        box-shadow: 0 4px 12px var(--dark-shadow);
      }

      .list-group-item {
        transition: all 0.3s ease;
        background-color: var(--light-card-bg);
        color: var(--light-text);
        border-color: var(--light-border);
      }

      .dark-mode .list-group-item {
        background-color: var(--dark-card-bg);
        color: var(--dark-text);
        border-color: var(--dark-border);
      }

      .accordion-item {
        background-color: var(--light-card-bg);
        border-color: var(--light-border);
        transition: background-color 0.3s ease, border-color 0.3s ease;
      }

      .dark-mode .accordion-item {
        background-color: var(--dark-card-bg);
        border-color: var(--dark-border);
      }

      .accordion-button {
        background-color: var(--light-card-bg);
        color: var(--light-text);
        transition: background-color 0.3s ease, color 0.3s ease;
      }

      .dark-mode .accordion-button {
        background-color: var(--dark-card-bg);
        color: var(--dark-text);
      }

      .accordion-button:not(.collapsed) {
        background-color: var(--accent-color);
        color: var(--primary-color);
      }

      .dark-mode .accordion-button:not(.collapsed) {
        background-color: var(--primary-color);
        color: var(--dark-text);
      }

      .accordion-button::after {
        transition: transform 0.3s ease;
      }

      .btn-primary,
      .bg-primary {
        background-color: var(--primary-color) !important;
        border-color: var(--primary-color) !important;
      }

      .btn-outline-primary {
        color: var(--primary-color) !important;
        border-color: var(--primary-color) !important;
      }

      .btn-outline-primary:hover {
        background-color: var(--primary-color) !important;
        color: white !important;
      }

      .text-primary {
        color: var(--primary-color) !important;
      }

      .dark-mode .text-primary {
        color: var (--secondary-color) !important;
      }

      /* Dark mode toggle */
      .dark-mode-toggle {
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 1000;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: var(--primary-color);
        border: none;
        color: white;
        box-shadow: 0 4px 10px var(--light-shadow);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .dark-mode .dark-mode-toggle {
        background-color: var(--secondary-color);
        box-shadow: 0 4px 10px var(--dark-shadow);
      }

      .dark-mode-toggle:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px var(--light-shadow);
      }

      .dark-mode .dark-mode-toggle:hover {
        box-shadow: 0 6px 12px var(--dark-shadow);
      }

      .dark-mode-toggle i {
        font-size: 1.5rem;
      }

      /* Animations */
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .fade-in {
        animation: fadeIn 0.3s ease;
      }

      .navbar {
        box-shadow: 0 6px 12px var(--light-shadow);
      }

      /* إصلاح الوضع الداكن لعناصر إضافية */
      body.dark-mode .navbar {
        background-color: var(--dark-bg) !important;
        color: var(--dark-text) !important;
        box-shadow: 0 6px 12px var(--dark-shadow) !important;
      }

      body.dark-mode .fade-in {
        background-color: var(--dark-card-bg) !important;
        color: var(--dark-text) !important;
      }

      body.dark-mode .accordion-button:not(.collapsed) {
        background-color: var(--primary-color) !important;
        color: var(--dark-text) !important;
      }

      body.dark-mode .alert {
        background-color: var(--dark-card-bg) !important;
        color: var(--dark-text) !important;
        border-color: var(--dark-border) !important;
      }

      body.dark-mode .list-group-item:hover {
        background-color: var(--dark-hover) !important;
        color: var(--dark-text) !important;
      }
    </style>
  </head>
  <body class="bg-light">
    <!-- Navbar -->
    <nav
      class="navbar navbar-expand-lg navbar-dark sticky-top"
      style="background-color: var(--primary-color)"
    >
      <div class="container-fluid">
        <a class="navbar-brand" href="#">إصدارات عماد الجزيري المجانية</a>
      </div>
    </nav>

    <div class="container-fluid mt-3">
      <div class="row flex-row">
        <!-- Sidebar on the right -->
        <div class="col-md-4">
          <div class="accordion" id="banksAccordion">
            <!-- سيتم إضافة الإصدارات هنا ديناميكياً -->
          </div>
        </div>

        <!-- Content Area -->
        <div class="col-md-8">
          <div
            class="fade-in p-4 rounded shadow-sm"
            id="contentArea"
            style="background-color: var(--light-card-bg)"
          >
            <h3 class="text-primary">أهلاً بك!</h3>
            <p>اختر البنك من القائمة اليمنى للاطلاع على الملفات والفيديوهات.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Dark Mode Toggle Button -->
    <button class="dark-mode-toggle" id="darkModeToggle" title="تبديل الوضع">
      <i class="bi bi-moon-fill" id="darkModeIcon"></i>
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // تهيئة وضع الألوان (فاتح/داكن)
      document.addEventListener("DOMContentLoaded", function () {
        // التحقق من وجود إعدادات سابقة في التخزين المحلي
        const isDarkMode = localStorage.getItem("darkMode") === "true";
        if (isDarkMode) {
          document.body.classList.add("dark-mode");
          document.body.classList.remove("bg-light");
          document
            .getElementById("darkModeIcon")
            .classList.remove("bi-moon-fill");
          document.getElementById("darkModeIcon").classList.add("bi-sun-fill");
        }

        // إضافة مستمع للزر
        document
          .getElementById("darkModeToggle")
          .addEventListener("click", function () {
            document.body.classList.toggle("dark-mode");
            document.body.classList.toggle("bg-light");
            const isDark = document.body.classList.contains("dark-mode");
            localStorage.setItem("darkMode", isDark);

            // تغيير أيقونة الزر
            const icon = document.getElementById("darkModeIcon");
            if (isDark) {
              icon.classList.remove("bi-moon-fill");
              icon.classList.add("bi-sun-fill");
            } else {
              icon.classList.remove("bi-sun-fill");
              icon.classList.add("bi-moon-fill");
            }
          });

        // تحميل قاعدة البيانات JSON
        fetch("banks.json")
          .then(response => response.json())
          .then(data => {
            initializeBanks(data.banks);
          })
          .catch(error => {
            console.error("Error loading banks data:", error);
            // يمكننا استخدام بيانات محلية في حالة الخطأ
            const banksData = {
              banks: [],
            };
            initializeBanks(banksData.banks);
          });
      });

      // ترتيب الإصدارات حسب رقم الـ id تصاعديًا
      function initializeBanks(banks) {
        const accordionEl = document.getElementById("banksAccordion");

        // ترتيب المصفوفة بناءً على id
        banks.sort((a, b) => a.id - b.id);

        // تفريغ المحتوى السابق
        accordionEl.innerHTML = "";

        // إضافة الإصدارات إلى الاكورديون وشريط التنقل
        banks.forEach((bank, index) => {
          // إضافة البنك إلى الاكورديون
          const isFirst = index === 0;
          const accordionHtml = `
            <div class="accordion-item">
              <h2 class="accordion-header" id="heading${bank.id}">
                <button 
                  class="accordion-button ${isFirst ? "" : "collapsed"}" 
                  type="button" 
                  data-bs-toggle="collapse" 
                  data-bs-target="#collapse${bank.id}"
                  aria-expanded="${isFirst ? "true" : "false"}"
                  aria-controls="collapse${bank.id}"
                >
                  ${bank.name}
                </button>
              </h2>
              <div 
                id="collapse${bank.id}" 
                class="accordion-collapse collapse ${isFirst ? "show" : ""}" 
                data-bs-parent="#banksAccordion"
              >
                <div class="accordion-body">
                  <ul class="list-group">
                    <li class="list-group-item bank-link" onclick="showBankContent(${
                      bank.id
                    }, 'video1')">
                      <i class="bi bi-play-circle me-2"></i> المقطع الأول
                    </li>
                    <li class="list-group-item bank-link" onclick="showBankContent(${
                      bank.id
                    }, 'video2')">
                      <i class="bi bi-play-circle me-2"></i> المقطع الثاني
                    </li>
                    <li class="list-group-item bank-link" onclick="showBankContent(${
                      bank.id
                    }, 'unsolved')">
                      <i class="bi bi-file-earmark me-2"></i> الملف غير المحلول
                    </li>
                    <li class="list-group-item bank-link" onclick="showBankContent(${
                      bank.id
                    }, 'solved')">
                      <i class="bi bi-file-earmark-check me-2"></i> الملف المحلول
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          `;
          accordionEl.innerHTML += accordionHtml;
        });

        // تحميل البنك الأول افتراضياً
        if (banks.length > 0) {
          showBankContent(banks[0].id, "video1");
        }
      }

      // عرض محتوى البنك عند النقر عليه
      function showBankContent(bankId, contentType = "video1") {
        fetch("banks.json")
          .then(response => response.json())
          .then(data => {
            const bank = data.banks.find(b => b.id === bankId);
            if (!bank) {
              throw new Error(`Bank with ID ${bankId} not found`);
            }

            const contentAreaEl = document.getElementById("contentArea");

            // إضافة عنوان البنك
            contentAreaEl.innerHTML = `
              <div class="text-center mb-4 fade-in">
                <h2 class="text-primary">${bank.name}</h2>
              </div>
            `;

            // إضافة المحتوى المناسب بناءً على نوع المحتوى المختار
            let contentHtml = "";

            switch (contentType) {
              case "video1":
                contentHtml = `
                  <div class="row fade-in">
                    <div class="col-12">
                      <div class="card">
                        <div class="card-body">
                          <h4 class="card-title d-flex justify-content-between align-items-center">
                            <div>
                            <i class="bi bi-play-circle-fill me-2"></i>المقطع الأول
                            </div>
                            <a href="https://www.youtube.com/watch?v=${bank.videos.explanation1}" target="_blank" class="btn btn-sm btn-outline-primary">
                              فتح في يوتيوب
                              <i class="bi bi-box-arrow-up-right ms-1"></i>
                            </a>
                          </h4>
                          <div class="video-container">
                            <iframe src="https://www.youtube.com/embed/${bank.videos.explanation1}?rel=0&modestbranding=1" 
                              title="فيديو الشرح الأول" 
                              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                              allowfullscreen></iframe>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                `;
                break;

              case "video2":
                contentHtml = `
                  <div class="row fade-in">
                    <div class="col-12">
                      <div class="card">
                        <div class="card-body">
                          <h4 class="card-title d-flex justify-content-between align-items-center">
                            <div>
                            <i class="bi bi-play-circle-fill me-2"></i>المقطع الثاني
                            </div>
                            <a href="https://www.youtube.com/watch?v=${bank.videos.explanation2}" target="_blank" class="btn btn-sm btn-outline-primary">
                              فتح في يوتيوب
                              <i class="bi bi-box-arrow-up-right ms-1"></i>
                            </a>
                          </h4>
                          <div class="video-container">
                            <iframe src="https://www.youtube.com/embed/${bank.videos.explanation2}?rel=0&modestbranding=1" 
                              title="فيديو الشرح الثاني" 
                              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                              allowfullscreen></iframe>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                `;
                break;

              case "solved":
                contentHtml = `
                  <div class="row fade-in">
                    <div class="col-12">
                      <div class="card">
                        <div class="card-body">
                          <h4 class="card-title d-flex justify-content-between align-items-center">
                            <div>
                            <i class="bi bi-file-earmark-text-fill me-2"></i>الملف المحلول
                            </div>
                            <a href="${bank.files.solved}" class="btn btn-sm btn-outline-primary" download>
                              <i class="bi bi-download me-1"></i>تحميل الملف
                            </a>
                          </h4>
                          <div class="pdf-container" style="height: 80vh;">
  <iframe src="https://mozilla.github.io/pdf.js/web/viewer.html?file=https://br495.github.io/tiqdr/${bank.files.solved}" width="100%" height="100%" style="border: none;"></iframe>
</div>
                        </div>
                      </div>
                    </div>
                  </div>
                `;
                break;

              case "unsolved":
                contentHtml = `
                  <div class="row fade-in">
                    <div class="col-12">
                      <div class="card">
                        <div class="card-body">
                          <h4 class="card-title d-flex justify-content-between align-items-center">
                            <div>
                              <i class="bi bi-file-earmark-fill me-2"></i>الملف غير المحلول
                            </div>
                            <a href="${bank.files.unsolved}" class="btn btn-sm btn-outline-primary" download>
                              <i class="bi bi-download me-1"></i>تحميل الملف
                            </a>
                          </h4>
                          <div class="pdf-container" style="height: 80vh;">
                            <object data="https://mozilla.github.io/pdf.js/web/viewer.html?file=https://br495.github.io/tiqdr/${bank.files.unsolved}" type="application/pdf" width="100%" height="100%">
                              <div class="alert alert-warning text-center p-5">
                                <i class="bi bi-exclamation-triangle-fill fs-1 d-block mb-3"></i>
                                <p>يبدو أن متصفحك لا يدعم عرض ملفات PDF.</p>
                                <a href="${bank.files.unsolved}" class="btn btn-primary mt-2" target="_blank">
                                  <i class="bi bi-download me-2"></i>تحميل الملف
                                </a>
                              </div>
                            </object>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                `;
                break;
            }

            contentAreaEl.innerHTML += contentHtml;
          })
          .catch(error => {
            console.error("Error loading bank content:", error);
            document.getElementById("contentArea").innerHTML = `
              <div class="alert alert-danger">
                خطأ في تحميل محتوى البنك. يرجى المحاولة مرة أخرى.
              </div>
            `;
          });
      }
    </script>
  </body>
</html>
